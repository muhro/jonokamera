<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Metropolia jonokamera</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="main.css">
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.2"></script>
    <!-- Load BodyPix -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/body-pix@2.0"></script>
    <script src="models/face-api.min.js"></script>
    <link rel="shortcut icon" type="image/png" href="img/MP-favicon.png"/>
    <script>
      window.addEventListener('load', (event) => {

      });

      document.addEventListener('readystatechange', (event) => {
      });

      document.addEventListener('DOMContentLoaded', (event) => {
      });
    </script>
</head>
<body onload="choiceFunction(); choiceKampus();">
<header class="headerC">
    <img src="img/MP-logo.png" class="img">
    <h1 class="kampus" id="kampus">Kampus<span class="triangle"></span></h1>
    <div class="dropdown">
        <div class="list" id="kampuslista" style="display: none">
            <h1 class="choice" id="152">Leiritie<span class="triangle"></span></h1>
            <h1 class="choice" id="152">HÃ¤meentie<span class="triangle"></span></h1>
            <h1 class="choice" id="158">Myllypuro<span class="triangle"></span></h1>
            <h1 class="choice" id="152">Vanha viertotie<span class="triangle"></span></h1>
        </div>
    </div>


</header>
<div class="leftDiv">
    <div class="otsikko">
        <img class="thumb" src="img/jono-img.png">
        <h2 class="otsikkoH1">RUOKALAN JONO</h2>
    </div>
    <div class="ruokalanjono">
        <canvas width="720" height="560" id="canvas" class="canvas"></canvas>
        <video class="video" id="video" width="720" height="560" autoplay muted loop src="img/testivideo.mp4">
        </video>
    </div>
</div>
<div class="rightDiv">
    <div class="otsikko">
        <img class="thumb" src="img/ruokalista-img.png">
        <h2 class="otsikkoH1">RUOKALISTA</h2>
    </div>
    <div class="ruokalista">
        <div class="moi" id="ruokaLista">
        </div>
    </div>
</div>


</body>
<script>

  Promise.all([
    faceapi.nets.tinyFaceDetector.loadFromUri('./models'),
    faceapi.nets.faceLandmark68Net.loadFromUri('./models'),
    faceapi.nets.faceRecognitionNet.loadFromUri('./models'),
    faceapi.nets.faceExpressionNet.loadFromUri('./models'),
  ]);

  loadAndPredict();

  const img = document.getElementById('video');
  const video = document.getElementById('video');

  async function loadAndPredict() {

    const net = await bodyPix.load({
      architecture: 'MobileNetV1',
      outputStride: 16,
      multiplier: 0.75,
      quantBytes: 2,

    });
    setInterval(async () => {
      const partSegmentation = await net.segmentPersonParts(img);


      const coloredPartImage = bodyPix.toColoredPartMask(partSegmentation);
      const opacity = 0.7;
      const flipHorizontal = false;
      const maskBlurAmount = 0;
      const pixelCellWidth = 10.0;

      const canvas = document.getElementById('canvas');

      const displaySize = {width: video.width, height: video.height};
      faceapi.matchDimensions(canvas, displaySize);

      canvas.getContext('2d').clearRect(0, 0, canvas.width, canvas.height);
      bodyPix.drawPixelatedMask(
          canvas, img, coloredPartImage, opacity, maskBlurAmount,
          flipHorizontal, pixelCellWidth);
    }, 60);
  }

  function choiceFunction() {
    document.getElementById('kampus').addEventListener('click', function() {
      if (document.getElementById('kampuslista').style.display === 'inline-flex') {
        document.getElementById('kampuslista').style.display = 'none';
      } else if (document.getElementById('kampuslista').style.display === 'none') {
        document.getElementById('kampuslista').style.display = 'inline-flex';
      }
    });
  }

  function choiceKampus() {

    let kampusButtons = document.getElementById('kampuslista');

    kampusButtons.addEventListener('click', function(event) {
      let innerHtml = event.target || event.srcElement;
      console.log(innerHtml.id);
      document.getElementById('kampus').innerHTML = innerHtml.innerHTML;
      document.getElementById('kampuslista').style.display = 'none';
    });
  }


</script>
<script src="main.js"></script>


</html>